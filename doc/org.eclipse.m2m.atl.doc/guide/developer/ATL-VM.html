<?xml version='1.0' encoding='utf-8' ?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
		<title>ATL Developer Guide - ATL VM</title>
		<link type="text/css" rel="stylesheet" href="book.css"/>
	</head>
	<body>
		<table class="navigation" style="width: 100%;" border="0" summary="navigation">
			<tr>
				<th style="width: 100%" align="center" colspan="3">ATL VM</th>
			</tr>
			<tr>
				<td style="width: 20%" align="left">
					<a href="ACG-ATL-VM-Code-Generator-.html" title="ACG (ATL VM Code Generator)">
						<img alt="Previous" border="0" src="images/images/prev.gif"/>
					</a>
				</td>
				<td style="width: 60%" align="center"></td>
				<td style="width: 20%" align="right">
					<a href="ASM-format.html" title="ASM format">
						<img alt="Next" border="0" src="images/images/next.gif"/>
					</a>
				</td>
			</tr>
			<tr>
				<td style="width: 20%" align="left" valign="top">ACG (ATL VM Code Generator)</td>
				<td style="width: 60%" align="center"></td>
				<td style="width: 20%" align="right" valign="top">ASM format</td>
			</tr>
		</table><hr/>
		<h1 id="ATL_VM">ATL VM</h1>
		<p>The ATL VM is a byte code interpreter which manages OCL and ATL types hierarchy and the model handler abstract layer. A complete ATL VM specification is available : 
			<a href="http://www.eclipse.org/m2m/atl/doc/ATL_VMSpecification%5Bv00.01%5D.pdf">ATL_VMSpecification</a>.
		</p>
		<p>This specification consists on a precise description of the ATL VM functionalities, but doesn't describe the implementation. The intent is to allow any developer to create an ATL VM in any language.
			This section attends to describe the ATL Regular VM implementation.</p>
		<h2 id="Launching">Launching</h2>
		<p>Several classes can launch the ATL VM, with different goals :</p>
		<ul>
			<li>The ASMInterpreter class launches the ATL VM. The realMain method is used to launch ATL VM in command line.</li>
			<li>The ASMProjector class is only defined to launch injections, extractions, or both without launching any transformation.</li>
			<li>The ASMEngine class is the real ATL VM command-line launcher that dispatches to ASMInterpreter, ASMProjector, or ACTInterpreter, depending on the arguments.</li>
			<li>The ACTInterpreter class is now unused and was historically used to launch ATL VM with ant-like scripts. It depends on XMLInjector. Thus, for coding facilities, this class is located into the ATL VM. For a coherence purpose, XMLExtractor is also located into the ATL VM. However the associated extension points are defined in the engine plugin.</li>
		</ul>
		<p>During ATL VM initialization, every operations are registered into a Map. The following schema explains ASMInterpreter functionment :</p>
		<p>
			<img border="0" src="images/ATL_ASMInterpreter.JPG"/>
		</p>
		<h2 id="Execution">Execution</h2>
		<p>The ExecEnv Class contains the virtual execution environment. It deals with the operation map which registers all operations used by the transformation. It contains every information used by a given execution, like models,  and is recreated for each execution.
			Operations are executed sequentially, into frames, according to their type. For instance, in ATL, a call of the append() method is directly mapped to a call to the corresponding method in the ASMSequence class.
			The Frame stores and throws all error messages. The ASMStackFrame is dedicated to ASM methods, when the StackFrame is dedicated to native methods.
			Execution errors come from ATL VM when the method Frame.printstacktrace is called.</p>
		<h2 id="Native_Library">Native Library</h2>
		<p>The 
			<a href="http://wiki.eclipse.org/ATL_Standard_Library">Native Library</a> (org.eclipse.m2m.atl.engine.vm.nativelib package) gathers all basic type definitions used by the ATL VM : OCL types and ATL specific types. Both are defined at the same level, and use reflexion.
			OCL appears at several levels in the ATL architecture :
		</p>
		<ul>
			<li>nativelib implementation</li>
			<li>OCL package in the ATL, ACG and TCS metamodels</li>
		</ul>
		<h2 id="Model_Handlers">Model Handlers</h2>
		<p>Model Handlers consists on an abstraction layer dedicated to model access. This access is implemented by two classes : ASMModel et ASMModelElement.</p>
		<p>Input and output models are loaded using the same API and are differenciated with an "isTarget" property. That API implements the "getMetaElementsByName" method which correspond to the "findme" ASM instruction.</p>
		<p>ATL contains three plugins drivers corresponding to different Model Handlers : EMF, MDR, UML2.
			Each plugin implements those abstract classes :</p>
		<ul>
			<li>AtlModelHandler : implementation of the basic tasks "newModel", "saveModel", "loadModel"</li>
			<li>ASMModel : getElementsByType implementation, framework oriented "newModelElement" method, etc...</li>
			<li>ASMModelElement : "allInstances" implementation, etc...</li>
		</ul>
		<p>The EMF4ATL is a particular case which doesn't contain the ModelHandler, which is placed in the org.eclipse.m2m.atl.engine plugin to facilitate implementation.</p><hr/>
		<table class="navigation" style="width: 100%;" border="0" summary="navigation">
			<tr>
				<td style="width: 20%" align="left">
					<a href="ACG-ATL-VM-Code-Generator-.html" title="ACG (ATL VM Code Generator)">
						<img alt="Previous" border="0" src="images/images/prev.gif"/>
					</a>
				</td>
				<td style="width: 60%" align="center">
					<a href="ATL Developer Guide.html" title="ATL Developer Guide">
						<img alt="ATL Developer Guide" border="0" src="images/images/home.gif"/>
					</a>
				</td>
				<td style="width: 20%" align="right">
					<a href="ASM-format.html" title="ASM format">
						<img alt="Next" border="0" src="images/images/next.gif"/>
					</a>
				</td>
			</tr>
			<tr>
				<td style="width: 20%" align="left" valign="top">ACG (ATL VM Code Generator)</td>
				<td style="width: 60%" align="center"></td>
				<td style="width: 20%" align="right" valign="top">ASM format</td>
			</tr>
		</table>
	</body>
</html>